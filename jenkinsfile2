import org.jenkinsci.plugins.scriptsecurity.scripts.*

  

def method = "something"

def signature = "something"



ScriptApproval sa = ScriptApproval.get();



//list pending approvals

for (ScriptApproval.PendingScript pending : sa.getPendingScripts()) {

        println "Pending Approved : " + pending.script

}



for (ScriptApproval.PendingSignature pending : sa.getPendingSignatures()) {

        println "Pending Approved : " + pending.signature

}  



// approve scripts

for (ScriptApproval.PendingScript pending : sa.getPendingScripts()) {

   if (pending.script.equals(method)) {

       	sa.approveScript(pending.getHash());

     	println "Approved : " + pending.script

      }

}



// approve signatures

for (ScriptApproval.PendingSignature pending : sa.getPendingSignatures()) {

   if (pending.equals(signature)) {

       	sa.approveSignature(pending.signature);

     	println "Approved : " + pending.signature

      }

}
